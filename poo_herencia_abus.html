<!DOCTYPE html>
<html class="writer-html5" lang="ca" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perill d&#39;abús d&#39;herència &mdash; Introducció a la programació amb Java 2023-24 documentació</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="_static/moistyle.css?v=0e2f4d36" />

  
    <link rel="shortcut icon" href="_static/logoprg.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4385e19b"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=d8dd923b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Interfaces" href="poo_interfaces.html" />
    <link rel="prev" title="Classes abstractes" href="poo_abstract.html" />
     
    <script class="googleanalytics" src="_static/moiscripts.js"></script>
    <meta name="robots" content="noindex">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Introducció a la programació amb Java
              <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Curs 2023-24
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Elements bàsics de la programació</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduls.html">Mòduls</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="poo_intro.html">Classes i objectes</a></li>
<li class="toctree-l2"><a class="reference internal" href="poo_constructors.html">Constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="poo_static.html">Membres d'instància i de classe</a></li>
<li class="toctree-l2"><a class="reference internal" href="poo_composicio.html">Composició</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="poo_herencia.html">Herència</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="poo_herencia_intro.html">El concepte d'herència</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_herencia_java.html">L'herència en Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_herencia_interficie.html">Interfície d'una classe</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_herencia_override.html">Comportaments específics</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_herencia_constructors.html">Herència i constructors</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_polimorfisme.html">Polimorfisme</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_abstract.html">Classes abstractes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Perill d'abús d'herència</a></li>
<li class="toctree-l3"><a class="reference internal" href="poo_interfaces.html"><em>Interfaces</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="poo_exercicis.html">Exercicis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bib.html">Biblioteques</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Validació d'aplicacions</a></li>
<li class="toctree-l1"><a class="reference internal" href="apendix.html">Apèndix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació amb Java</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="poo.html">Programació Orientada a Objectes</a></li>
          <li class="breadcrumb-item"><a href="poo_herencia.html">Herència</a></li>
      <li class="breadcrumb-item active">Perill d'abús d'herència</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="poo_abstract.html" class="btn btn-neutral float-left" title="Classes abstractes" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="poo_interfaces.html" class="btn btn-neutral float-right" title="Interfaces" accesskey="n">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
           <div itemprop="articleBody">
             
  <section id="perill-d-abus-d-herencia">
<h1>Perill d'abús d'herència<a class="headerlink" href="#perill-d-abus-d-herencia" title="Enllaça amb aquesta capçalera"></a></h1>
<p>És típic quan descobreixes l'herència, com qualsevol altra
tècnica/utilitat/…, voler-la fer servir per tot arreu.</p>
<p>Abans que ens emocionem amb l'herència, cal que tinguem clar què té sentit
i què no.</p>
<p>Per exemple, imagina't que has d'implementar la classe <code class="docutils literal notranslate"><span class="pre">TargetaMetro</span></code>
que té un cert nombre de viatges que es van gastant a mida que es fa
servir la targeta. En crear la targeta, queda pre-carregada amb un nombre
de viatges. El nombre de viatges mai no ha de ser negatiu i s'ha de poder
anar eliminant d'un en un per cada ús. Un cop exhaurits tots els viatges,
la targeta no és usable a menys que es torni a recarregar.</p>
<p>Potser se'ns podria ocórrer la <em>brillant</em> idea de comparar els viatges amb
les vides d'un <code class="docutils literal notranslate"><span class="pre">GatRenat</span></code> i així estalviar-nos un munt de codi:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TargetaMetro</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GatRenat</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">2</span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">TargetaMetro</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">viatgesInicials</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">3</span><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">viatgesInicials</span><span class="p">);</span>
<span class="linenos">4</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">5</span><span class="p">}</span>
</pre></div>
</div>
<p>Ara, l'ús de la targeta (la pèrdua d'un viatge) la podem executar amb el
mètode <code class="docutils literal notranslate"><span class="pre">mor()</span></code> que treu una vida/viatge fins que ja no en queden més.
Saber si encara queden viatges ho podem resoldre amb el mètode
<code class="docutils literal notranslate"><span class="pre">esViu()</span></code> i la recàrrega amb <code class="docutils literal notranslate"><span class="pre">reviu()</span></code>.`</p>
<p>És cert que ens estalviem tot de codificació, però… tenim una targeta de
viatges que miola.</p>
<p>Per poder saber quines herències tenen sentit i quines no, hem de fer ús
del principi de substitució de <a class="reference external" href="http://en.wikipedia.org/wiki/Barbara_Jane_Liskov">Liskov</a>:</p>
<blockquote>
<div><p>una herència entre dues classes està correctament definida si
<strong>sempre</strong> es pot fer servir una instància de la subclasse allà on
el programa espera una instància de la superclasse.</p>
</div></blockquote>
<p>Un exemple típic d'herència incorrecta és entre Quadrat i Rectangle (o
també Cercle i Oval). Suposa que tens les següents classes:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Rectangle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">     </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="n">altura</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="nf">Rectangle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">altura</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 4</span><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="na">base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">base</span><span class="p">;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">altura</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">altura</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="p">}</span>
<span class="linenos"> 6</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getBase</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">base</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getAltura</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">altura</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 8</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setBase</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">base</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">base</span><span class="o">=</span><span class="n">base</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 9</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAltura</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">altura</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">altura</span><span class="o">=</span><span class="n">altura</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">10</span><span class="w">     </span><span class="cm">/* … */</span>
<span class="linenos">11</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Quadrat</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">14</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="nf">Quadrat</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">costat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">15</span><span class="w">         </span><span class="kd">super</span><span class="p">(</span><span class="n">costat</span><span class="p">,</span><span class="w"> </span><span class="n">costat</span><span class="p">);</span>
<span class="linenos">16</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">17</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getCostat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">getBase</span><span class="p">();</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">18</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setCostat</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">costat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">         </span><span class="n">setBase</span><span class="p">(</span><span class="n">costat</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">         </span><span class="n">setAltura</span><span class="p">(</span><span class="n">costat</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">22</span><span class="w">     </span><span class="cm">/* … */</span>
<span class="linenos">23</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Malgrat que, en principi, una herència com aquesta pot semblar una
bona idea (especialment si els «…» inclouen molt de codi, en
realitat amaga una desagradable sorpresa. Considera el següent codi:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UsaRectangles</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 3</span><span class="w">         </span><span class="n">Rectangle</span><span class="o">[]</span><span class="w"> </span><span class="n">rectangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rectangle</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w">         </span><span class="n">rectangles</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rectangle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="linenos"> 5</span><span class="w">         </span><span class="n">rectangles</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Quadrat</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="linenos"> 6</span><span class="w">         </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Rectangle</span><span class="w"> </span><span class="n">r</span><span class="p">:</span><span class="w"> </span><span class="n">rectangles</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 7</span><span class="w">             </span><span class="n">r</span><span class="p">.</span><span class="na">setBase</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="na">getBase</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// encongeix la base</span>
<span class="linenos"> 8</span><span class="w">         </span><span class="p">}</span>
<span class="linenos"> 9</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">10</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>En <code class="docutils literal notranslate"><span class="pre">UsaRectangles</span></code> aconseguim que la instància de Quadrat
referenciada per <code class="docutils literal notranslate"><span class="pre">rectangles[1]</span></code> acabi tenint un quadrat de costat 3
i 4!. És a dir, hem aconseguit <em>petar</em> la coherència de la classe i
tot fent-la servir &quot;legalment&quot;.</p>
<p>El problema de l'exemple és que un quadrat <strong>no</strong> es pot considerar un
rectangle en tots els contexts on s'espera que es comporti
correctament un rectangle (ex. quan encongim un dels seus costats)</p>
<p>En resum, abans de crear una subclasse <code class="docutils literal notranslate"><span class="pre">B</span></code> d'una classe <code class="docutils literal notranslate"><span class="pre">A</span></code>,
assegurem-nos que podem dir que tot <code class="docutils literal notranslate"><span class="pre">B</span></code> <strong>és un</strong> <code class="docutils literal notranslate"><span class="pre">A</span></code>. No n'hi ha prou
amb que <em>algun</em> <code class="docutils literal notranslate"><span class="pre">B</span></code> és un <code class="docutils literal notranslate"><span class="pre">A</span></code>, o tot <code class="docutils literal notranslate"><span class="pre">B</span></code> s'<em>assembla</em> a <code class="docutils literal notranslate"><span class="pre">A</span></code>, o <em>és
pràcticament un</em> <code class="docutils literal notranslate"><span class="pre">A</span></code> excepte per algun detall, etc.</p>
<p>Una altra cosa que hem de tenir sempre present en llenguatges com Java, és
que l'herència és <em>d'un sol tret</em> en el sentit que només podem estendre
una classe. Per sort, disposem d'altres mecanismes que ens permetran
salvar aquesta aparent limitació. No et perdis el següent episodi…</p>
</section>


           </div>
          </div>
    <div class="googleanalytics">
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>
    <script>setCookiesboxVisibility();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41103782-2', 'auto');
      ga('send', 'pageview');
    </script>
</div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="poo_abstract.html" class="btn btn-neutral float-left" title="Classes abstractes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="poo_interfaces.html" class="btn btn-neutral float-right" title="Interfaces" accesskey="n" rel="next">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024 Moisès Gómez Girón.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41103782-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-41103782-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>