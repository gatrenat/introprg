<!DOCTYPE html>
<html class="writer-html5" lang="ca" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercici 36_09. Eliminació de categories i animals &mdash; Introducció a la programació amb Java 2023-24 documentació</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="_static/moistyle.css?v=0e2f4d36" />

  
    <link rel="shortcut icon" href="_static/logoprg.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4385e19b"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=d8dd923b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Exercici 36_10. La botiga de vins en base de dades" href="exercici_36_10_botigabd_ineficient.html" />
    <link rel="prev" title="Exercici 36_08. Modificació d&#39;animals" href="exercici_36_08_update.html" />
     
    <script class="googleanalytics" src="_static/moiscripts.js"></script>
    <meta name="robots" content="noindex">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Introducció a la programació amb Java
              <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Curs 2023-24
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Elements bàsics de la programació</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduls.html">Mòduls</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a></li>
<li class="toctree-l1"><a class="reference internal" href="bib.html">Biblioteques</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Validació d'aplicacions</a></li>
<li class="toctree-l1"><a class="reference internal" href="refactoring.html">Refactoring</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bd.html">Persistència amb bases de dades</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bd_modelrelacional_i_poo.html">POO i Model Relacional</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_sgbd.html">SGBD</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_jdbc.html">JDBC</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_consultes.html">El Zoo persistent</a></li>
<li class="toctree-l2"><a class="reference internal" href="bd_conclusions.html">Conclusions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bd_exercicis.html">Exercicis de persistència</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exercici_36_01_jdbc.html"> Exercici 36_01. A veure si ho he entès bé</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_02_drop.html"> Exercici 36_02. Elimina taula <em>CATEGORIES</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_03_select.html"> Exercici 36_03. Consulta de categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_04_id.html"> Exercici 36_04. Recuperar l'identificador</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_05_animals.html"> Exercici 36_05. Creació i destrucció de la taula <em>ANIMALS</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_06_insert.html"> Exercici 36_06. Inserció d'animals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_07_select.html"> Exercici 36_07. Recuperar animals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_08_update.html"> Exercici 36_08. Modificació d'animals</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Exercici 36_09. Eliminació de categories i animals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_10_botigabd_ineficient.html"> Exercici 36_10. La botiga de vins en base de dades</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_11_botigabd_eficient.html"> Exercici 36_11. La botiga de vins <em>eficient</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_12_botigabd_fullbd.html"> Exercici 36_12. La botiga de vins <em>full-bd</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_36_13_botigabd_barata.html"> Exercici 36_13. Una botiga <em>barata</em> de vins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apendix.html">Apèndix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació amb Java</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="bd.html">Persistència amb bases de dades</a></li>
          <li class="breadcrumb-item"><a href="bd_exercicis.html">Exercicis de persistència</a></li>
      <li class="breadcrumb-item active"> Exercici 36_09. Eliminació de categories i animals</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="exercici_36_08_update.html" class="btn btn-neutral float-left" title="Exercici 36_08. Modificació d&#39;animals" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="exercici_36_10_botigabd_ineficient.html" class="btn btn-neutral float-right" title="Exercici 36_10. La botiga de vins en base de dades" accesskey="n">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
           <div itemprop="articleBody">
             
  <section id="exerciseicon-t-exercici-36-09-eliminacio-de-categories-i-animals">
<h1><img alt="exerciseicon__T" src="_images/exerciseicon__T.png" /> Exercici 36_09. Eliminació de categories i animals<a class="headerlink" href="#exerciseicon-t-exercici-36-09-eliminacio-de-categories-i-animals" title="Enllaça amb aquesta capçalera"></a></h1>
<p class="rubric">Context</p>
<ul class="simple">
<li><p>Carpeta de lliurament: <code class="docutils literal notranslate"><span class="pre">36_09_delete/</span></code></p></li>
<li><p>Continguts relacionats: <a class="reference internal" href="bd_consultes.html"><span class="doc">El Zoo persistent</span></a></p></li>
<li><p>Com lliurar-lo: <a class="reference internal" href="com_lliurar.html#instruccions-git"><span class="std std-ref">instruccions</span></a></p></li>
<li><p>[✓] Exercici amb <a class="reference internal" href="sobre_exercicis.html#descripcio-exercicis-autoavaluacio"><span class="std std-ref">autoavaluació</span></a></p></li>
</ul>
<p class="rubric">Enunciat</p>
<p>En aquest exercici implementarem els mètodes de <code class="docutils literal notranslate"><span class="pre">Zoo</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">eliminaAnimal(Animal</span> <span class="pre">animal)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">eliminaCategoria(Categoria</span> <span class="pre">categoria)</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code> eliminarà el registre corresponent d'animal només
considerant l'identificador. Si l'animal té l'identificador indefinit, o
bé no hi ha cap registre amb aquest <code class="docutils literal notranslate"><span class="pre">id</span></code>,
no farà res.</p>
<p><code class="docutils literal notranslate"><span class="pre">eliminaCategoria()</span></code> realitzarà l'eliminació <em>en cascada</em> tot eliminant
abans els animals que puguin tenir aquesta categoria assignada. Si no hi
ha cap categoria amb l'identificador de la rebuda, o bé aquesta el té
indefinit, no farà res.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Arrays</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.LinkedList</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UsaZoo</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">args</span><span class="o">[]</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="n">Zoo</span><span class="w"> </span><span class="n">zoo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Zoo</span><span class="p">();</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Primer connectem amb la base de dades: &quot;</span><span class="p">);</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">connecta</span><span class="p">();</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;connectat&quot;</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">14</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Creem les taules&quot;</span><span class="p">);</span>
<span class="linenos">15</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">creaTaulaAnimals</span><span class="p">();</span>
<span class="linenos">16</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Taules resultants: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zoo</span><span class="p">.</span><span class="na">getNomTaules</span><span class="p">());</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Intentem eliminar una categoria i un animal inexistents&quot;</span><span class="p">);</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">));</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gat&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">)));</span>
<span class="linenos">21</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">22</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="w">        </span><span class="n">Animal</span><span class="w"> </span><span class="n">pardal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;pardal&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">));</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Introduïm &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pardal</span><span class="p">);</span>
<span class="linenos">27</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">afegeixAnimal</span><span class="p">(</span><span class="n">pardal</span><span class="p">);</span>
<span class="linenos">28</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">29</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">32</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem l&#39;animal&quot;</span><span class="p">);</span>
<span class="linenos">33</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="n">pardal</span><span class="p">);</span>
<span class="linenos">34</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">35</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="w">        </span><span class="c1">// creem una llista d&#39;animals</span>
<span class="linenos">38</span><span class="w">        </span><span class="n">Categoria</span><span class="w"> </span><span class="n">ocell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">);</span>
<span class="linenos">39</span><span class="w">        </span><span class="n">Animal</span><span class="w"> </span><span class="n">gat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gat&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Categoria</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">));</span>
<span class="linenos">40</span><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Animal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
<span class="linenos">41</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;pardal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ocell</span><span class="p">),</span>
<span class="linenos">42</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;àliga&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ocell</span><span class="p">),</span>
<span class="linenos">43</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;gallina&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">ocell</span><span class="p">),</span>
<span class="linenos">44</span><span class="w">            </span><span class="n">gat</span><span class="p">,</span>
<span class="linenos">45</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">(</span><span class="s">&quot;trencalós&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">ocell</span><span class="p">)</span>
<span class="linenos">46</span><span class="w">            </span><span class="p">);</span>
<span class="linenos">47</span>
<span class="linenos">48</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">49</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Afegim uns quants animals&quot;</span><span class="p">);</span>
<span class="linenos">50</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Animal</span><span class="w"> </span><span class="n">animal</span><span class="p">:</span><span class="w"> </span><span class="n">animals</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">51</span><span class="w">            </span><span class="n">zoo</span><span class="p">.</span><span class="na">afegeixAnimal</span><span class="p">(</span><span class="n">animal</span><span class="p">);</span>
<span class="linenos">52</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">53</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">54</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="w">        </span><span class="n">ocell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zoo</span><span class="p">.</span><span class="na">obteCategoriaPerNom</span><span class="p">(</span><span class="s">&quot;ocell&quot;</span><span class="p">);</span>
<span class="linenos">57</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">58</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ocell</span><span class="p">);</span>
<span class="linenos">59</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="n">ocell</span><span class="p">);</span>
<span class="linenos">60</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">61</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">62</span>
<span class="linenos">63</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">64</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No deixem ni el gat!&quot;</span><span class="p">);</span>
<span class="linenos">65</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaAnimal</span><span class="p">(</span><span class="n">gat</span><span class="p">);</span>
<span class="linenos">66</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">67</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">68</span>
<span class="linenos">69</span><span class="w">        </span><span class="n">Categoria</span><span class="w"> </span><span class="n">mamifer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zoo</span><span class="p">.</span><span class="na">obteCategoriaPerNom</span><span class="p">(</span><span class="s">&quot;mamífer&quot;</span><span class="p">);</span>
<span class="linenos">70</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">71</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Eliminem &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mamifer</span><span class="p">);</span>
<span class="linenos">72</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">eliminaCategoria</span><span class="p">(</span><span class="n">mamifer</span><span class="p">);</span>
<span class="linenos">73</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraAnimals</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaAnimals</span><span class="p">());</span>
<span class="linenos">74</span><span class="w">        </span><span class="n">ZooUtils</span><span class="p">.</span><span class="na">mostraCategories</span><span class="p">(</span><span class="n">zoo</span><span class="p">.</span><span class="na">recuperaCategories</span><span class="p">());</span>
<span class="linenos">75</span>
<span class="linenos">76</span>
<span class="linenos">77</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
<span class="linenos">78</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Finalment tanquem la connexió amb la base de dades: &quot;</span><span class="p">);</span>
<span class="linenos">79</span><span class="w">        </span><span class="n">zoo</span><span class="p">.</span><span class="na">desconnecta</span><span class="p">();</span>
<span class="linenos">80</span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;desconnectat&quot;</span><span class="p">);</span>
<span class="linenos">81</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">82</span><span class="p">}</span>
</pre></div>
</div>
<p>Amb la sortida esperada:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>java<span class="w"> </span>UsaZoo
<span class="hll"><span class="go">Primer connectem amb la base de dades: connectat</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Creem les taules</span>
</span><span class="hll"><span class="go">Taules resultants: ANIMALS, CATEGORIES</span>
</span><span class="hll"><span class="go">Intentem eliminar una categoria i un animal inexistents</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Cap categoria</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Introduïm Animal(id:indefinit, pardal, Categoria(id:indefinit, ocell))</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 1</span>
</span><span class="hll"><span class="go">    Animal(id:1, pardal, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem l&#39;animal</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Afegim uns quants animals</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 5</span>
</span><span class="hll"><span class="go">    Animal(id:4, gallina, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:5, gat, Categoria(id:2, mamífer))</span>
</span><span class="hll"><span class="go">    Animal(id:2, pardal, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:6, trencalós, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">    Animal(id:3, àliga, Categoria(id:1, ocell))</span>
</span><span class="hll"><span class="go">Nombre de categories: 2</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll"><span class="go">    Categoria(id:1, ocell)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem Categoria(id:1, ocell)</span>
</span><span class="hll"><span class="go">Nombre d&#39;animals: 1</span>
</span><span class="hll"><span class="go">    Animal(id:5, gat, Categoria(id:2, mamífer))</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">No deixem ni el gat!</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Nombre de categories: 1</span>
</span><span class="hll"><span class="go">    Categoria(id:2, mamífer)</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Eliminem Categoria(id:2, mamífer)</span>
</span><span class="hll"><span class="go">Cap animal</span>
</span><span class="hll"><span class="go">Cap categoria</span>
</span><span class="hll">
</span><span class="hll"><span class="go">Finalment tanquem la connexió amb la base de dades: desconnectat</span>
</span></pre></div>
</div>
<section id="ampliacio">
<h2>☼ Ampliació<a class="headerlink" href="#ampliacio" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Aquests nous mètodes descobreixen un error que tenim a altres mètodes (ex.
<code class="docutils literal notranslate"><span class="pre">afegeixAnimal()</span></code> que pressuposen que si la instància respon
<code class="docutils literal notranslate"><span class="pre">false</span></code> a la crida del mètode <code class="docutils literal notranslate"><span class="pre">idIndefinit()</span></code> llavors segur que està a
la base de dades.</p>
<p>Això ja veiem que no sempre serà cert. Sense anar més lluny, si eliminem
un animal amb <code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code>, la instància conserva el seu <code class="docutils literal notranslate"><span class="pre">id</span></code>
original.</p>
<p>Podries pensar que és fàcil de resoldre fent que <code class="docutils literal notranslate"><span class="pre">eliminaAnimal()</span></code>
marqui la instància com a indefinida, per exemple afegint un nou mètode a
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> (ex. <code class="docutils literal notranslate"><span class="pre">unsetId()</span></code>)</p>
<p>Si bé podem solucionar una mica el problema, no el resolem de ple. Com ens
ho fem per modificar totes les instàncies d'animal que pugui tenir el
nostre programa si els seus registres són eliminats de la base de dades en
eliminar la seva categoria?
Encara més, el valor del <code class="docutils literal notranslate"><span class="pre">id</span></code> el podem assignar de manera arbitrària en
crear l'animal doncs no comprova que aquest correspongui realment a una
entrada de  <em>ANIMALS</em>.
I no s'acaba aquí! Hi ha casos <em>patològics</em> com ara que un animal hagi
estat guardat i després se li canviï la categoria per una que no estigui a
la base de dades! Se t'acudeixen més vulnerabilitats?</p>
<p>En resum, que ens tocarà afegir la comprovació a tots els mètodes
implicats, de que l'identificador de cada entitat realment correspongui
amb una entrada de la taula corresponent. Fes tots els que se t'acudeixin
i et vinguin de gust.</p>
<p>Aquesta és la proposta d'ampliació. Si vols fer-la, et proposo que
afegeixis un <code class="docutils literal notranslate"><span class="pre">UsaZooAmpliat</span></code> per provar que funciona cada cas que hagis
implementat. Demana ajut si et costa pensar en les proves.</p>
</section>
</section>


           </div>
          </div>
    <div class="googleanalytics">
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>
    <script>setCookiesboxVisibility();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41103782-2', 'auto');
      ga('send', 'pageview');
    </script>
</div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="exercici_36_08_update.html" class="btn btn-neutral float-left" title="Exercici 36_08. Modificació d&#39;animals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="exercici_36_10_botigabd_ineficient.html" class="btn btn-neutral float-right" title="Exercici 36_10. La botiga de vins en base de dades" accesskey="n" rel="next">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024 Moisès Gómez Girón.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41103782-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-41103782-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>