<!DOCTYPE html>
<html class="writer-html5" lang="ca" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercici 33_06. El fitxer de log &mdash; Introducció a la programació amb Java 2023-24 documentació</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="_static/moistyle.css?v=0e2f4d36" />

  
    <link rel="shortcut icon" href="_static/logoprg.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4385e19b"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=d8dd923b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Exercici 33_07. Classificador de matrícules" href="exercici_33_07_classificador.html" />
    <link rel="prev" title="Exercici 33_05. Traducció" href="exercici_33_05_traduccio.html" />
     
    <script class="googleanalytics" src="_static/moiscripts.js"></script>
    <meta name="robots" content="noindex">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Introducció a la programació amb Java
              <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Curs 2023-24
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Elements bàsics de la programació</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduls.html">Mòduls</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="fitxers.html">Fitxers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fitxers_intro.html">Primeres definicions</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitxers_lectura.html">Lectura de fitxers de text</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitxers_escriptura.html">Escriptura en fitxers de text</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitxers_registres.html">Registres</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitxers_gestio.html">Gestió de fitxers en Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitxers_conclusions.html">Conclusions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="fitxers_exercicis.html">Llistat d'exercicis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exercici_33_01_excepcional.html"> Exercici 33_01. Situacions excepcionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_02_vocal_inici_fi.html"> Exercici 33_02. Vocals a l'inici o al final</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_03_csv.html"> Exercici 33_03. Valors separats per comes</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_04_lloro_memoria.html"> Exercici 33_04. El lloro amb memòria</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_05_traduccio.html"> Exercici 33_05. Traducció</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Exercici 33_06. El fitxer de log</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_07_classificador.html"> Exercici 33_07. Classificador de matrícules</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_08_alumnes.html"> Exercici 33_08. Alumnes</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_09_inspecciona.html"> Exercici 33_09. Inspecció d'un fitxer</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_33_10_classificador_dups.html"> Exercici 33_10. Classificador de matrícules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apendix.html">Apèndix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació amb Java</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="fitxers.html">Fitxers</a></li>
          <li class="breadcrumb-item"><a href="fitxers_exercicis.html">Llistat d'exercicis</a></li>
      <li class="breadcrumb-item active"> Exercici 33_06. El fitxer de log</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="exercici_33_05_traduccio.html" class="btn btn-neutral float-left" title="Exercici 33_05. Traducció" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="exercici_33_07_classificador.html" class="btn btn-neutral float-right" title="Exercici 33_07. Classificador de matrícules" accesskey="n">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
           <div itemprop="articleBody">
             
  <section id="exerciseicon-t-exercici-33-06-el-fitxer-de-log">
<h1><img alt="exerciseicon__T" src="_images/exerciseicon__T.png" /> Exercici 33_06. El fitxer de log<a class="headerlink" href="#exerciseicon-t-exercici-33-06-el-fitxer-de-log" title="Enllaça amb aquesta capçalera"></a></h1>
<p class="rubric">Context</p>
<ul class="simple">
<li><p>Carpeta de lliurament: <code class="docutils literal notranslate"><span class="pre">33_06_log/</span></code></p></li>
<li><p>Continguts relacionats: <a class="reference internal" href="fitxers_escriptura.html"><span class="doc">Escriptura en fitxers de text</span></a></p></li>
<li><p>Com lliurar-lo: <a class="reference internal" href="com_lliurar.html#instruccions-git"><span class="std std-ref">instruccions</span></a></p></li>
<li><p>[✓] Exercici amb <a class="reference internal" href="sobre_exercicis.html#descripcio-exercicis-autoavaluacio"><span class="std std-ref">autoavaluació</span></a></p></li>
</ul>
<p class="rubric">Enunciat</p>
<p>Quan executem programes complexos, sol ser interessant poder registrar les
situacions significatives que es van produint. Això ens permet a
posteriori entre altres coses, auditar com s'ha executat, descobrir i
reproduir errors.</p>
<p>Aquests registres es solen guardar en un fitxer de text amb una o més
línies que descriuen què ha passat i sovint quan va passar. A aquest
fitxer se'l sol conèixer com a <em>fitxer de log</em>.</p>
<p>Els fitxers de log es poden veure com una mena de diari que descriu
aspectes de l'execució d'un o més programes.</p>
<p>Per implementar el registre, es sol fer mitjançant crides a mòduls que
escriuen al fitxer, sense que el programa que els fa servir se n'hagi de
preocupar de res més. Com si fes un <code class="docutils literal notranslate"><span class="pre">System.out.println()</span></code>.</p>
<p>En aquesta ocasió desenvoluparem una biblioteca d'utilitats per guardar un
registre de les accions que van succeint al nostre programa.</p>
<p>Per simplicitat, la nostra biblioteca considerarà que el fitxer de log es
diu <code class="docutils literal notranslate"><span class="pre">log.txt</span></code> i es guardarà a la carpeta actual (des d'on executem el
programa)</p>
<section id="moduls-de-registre">
<h2>Mòduls de registre<a class="headerlink" href="#moduls-de-registre" title="Enllaça amb aquesta capçalera"></a></h2>
<p>La nostra biblioteca es dirà <cite>Log</cite> i oferirà els següents mòduls públics:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">printError(String)</span></code></p>
<blockquote>
<div><p>Per indicar errors greus, sovint irrecuperables Ex. S'ha quedat sense
espai el disc.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">printWarning(String)</span></code></p>
<blockquote>
<div><p>Per indicar situacions anòmales que, si bé són recuperables, poden
esdevenir un error. Ex. falta un fitxer de configuració.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">printInfo(String)</span></code></p>
<blockquote>
<div><p>Permet indicar informació general, normalment no problemàtica, com
ara, l'inici i finalització d'una execució.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">printDebug(String)</span></code></p>
<blockquote>
<div><p>Permet indicar detalls de l'execució, com per exemple, la crida a un
mòdul amb els arguments que se li passen o l'opertura/tancament dels
fitxers.</p>
<p>Aquests detalls es solen fer servir per depurar (debug) possibles
errors en el codi de l'aplicació.</p>
</div></blockquote>
</li>
</ul>
<p>Quan són cridats, aquests mòduls obren el fitxer de log per ampliació,
escriuen el missatge i el tanquen. Addicionalment retornen la línia que han
escrit.</p>
<p>Els quatre mòduls reben un missatge de text i el guarden com una línia
nova al fitxer <code class="docutils literal notranslate"><span class="pre">./log.txt</span></code> de manera que si ja existia, n'afegirà les
noves línies al final de les existents, i si no existia, en crearà un de
nou.</p>
<p>Els mòduls s'inclouran com a mòduls estàtics dins d'una classe
anomenada <code class="docutils literal notranslate"><span class="pre">Log</span></code>, de manera que seran cridats així:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Log</span><span class="p">.</span><span class="na">printDebug</span><span class="p">(</span><span class="s">&quot;quantesVocals(\&quot;Vocals\&quot;) retorna 2&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="contingut-d-un-registre">
<h2>Contingut d'un registre<a class="headerlink" href="#contingut-d-un-registre" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Cada registre tindrà la següent informació:</p>
<ul class="simple">
<li><p>seqüencial: el nombre d'entrades de log introduïdes prèviament dins
d'aquesta execució. Comença a comptar per 1.</p></li>
<li><p>tipus: <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>, <code class="docutils literal notranslate"><span class="pre">WARNING</span></code>, <code class="docutils literal notranslate"><span class="pre">INFO</span></code>, <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code></p></li>
<li><p>missatge proporcionat</p></li>
</ul>
<p>Així, per la crida anterior, el missatge resultant podria ser:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[324] DEBUG: quantesVocals(&quot;Vocals&quot;) retorna 2
</pre></div>
</div>
<p>Per descomptat, en cas que ens sigui d'interès, podrem disposar de la
línia escrita al fitxer de log, de la següent manerea:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">liniaEscrita</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Log</span><span class="p">.</span><span class="na">printDebug</span><span class="p">(</span><span class="s">&quot;quantesVocals(\&quot;Vocals\&quot;) retorna 2&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>En un log real, normalment s'indica la data i hora en que es registra cada
execució. Per simplificar les proves, en aquesta ocasió només guardarem un número
seqüencial que indicarà quantes línies s'han escrit fins aquell moment en
aquesta execució.  Així, la primera línia que s'escrigui portarà
normalment el número 1, la segona el 2, etc.</p>
<p>Per implementar aquesta funcionalitat, et proposo que facis servir una
variable global (fes-la privada, d'acord?)</p>
<p>La nostra biblioteca oferirà un mòdul addicional, anomenat <code class="docutils literal notranslate"><span class="pre">reset()</span></code>,
que permetrà reiniciar el comptador.  En ser cridat, la següent línia que
es registri tornarà a començar pel número 1.</p>
</section>
<section id="provem-la-nostra-biblioteca">
<h2>Provem la nostra biblioteca<a class="headerlink" href="#provem-la-nostra-biblioteca" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Per poder provar <code class="docutils literal notranslate"><span class="pre">Log</span></code>, fes servir el següent codi:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UsaLog</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 7</span><span class="w">       </span><span class="n">Log</span><span class="p">.</span><span class="na">printError</span><span class="p">(</span><span class="s">&quot;Això és un error greu&quot;</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">       </span><span class="n">Log</span><span class="p">.</span><span class="na">printWarning</span><span class="p">(</span><span class="s">&quot;Això és un avís&quot;</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">           </span><span class="n">Log</span><span class="p">.</span><span class="na">printInfo</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;Argument %d: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">));</span>
<span class="linenos">11</span><span class="w">       </span><span class="p">}</span>
<span class="linenos">12</span><span class="w">       </span><span class="n">Log</span><span class="p">.</span><span class="na">reset</span><span class="p">();</span><span class="w">     </span><span class="c1">// comencem a comptar un altre cop</span>
<span class="linenos">13</span><span class="w">       </span><span class="n">Log</span><span class="p">.</span><span class="na">printDebug</span><span class="p">(</span><span class="s">&quot;Aquí s&#39;acaba el main()&quot;</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">   </span><span class="p">}</span>
<span class="linenos">15</span><span class="p">}</span>
</pre></div>
</div>
<p>Considera la següent execució:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat<span class="w"> </span>log.txt<span class="w">               </span><span class="c1"># Comprovem que no existeix inicialment</span>
<span class="go">cat: log.txt: El fitxer o directori no existeix</span>
<span class="gp">$ </span>java<span class="w"> </span>UsaLog<span class="w">               </span><span class="c1"># Primera execució</span>
<span class="gp">$ </span>cat<span class="w"> </span>log.txt
<span class="go">[1] ERROR: Això és un error greu</span>
<span class="go">[2] WARNING: Això és un avís</span>
<span class="go">[1] DEBUG: Aquí s&#39;acaba el main()</span>
<span class="gp">$ </span>java<span class="w"> </span>UsaLog<span class="w"> </span>un<span class="w"> </span>dos<span class="w"> </span>tres<span class="w">   </span><span class="c1"># Segona execució</span>
<span class="gp">$ </span>cat<span class="w"> </span>log.txt
<span class="go">[1] ERROR: Això és un error greu</span>
<span class="go">[2] WARNING: Això és un avís</span>
<span class="go">[1] DEBUG: Aquí s&#39;acaba el main()</span>
<span class="go">[1] ERROR: Això és un error greu</span>
<span class="go">[2] WARNING: Això és un avís</span>
<span class="go">[3] INFO: Argument 0: un</span>
<span class="go">[4] INFO: Argument 1: dos</span>
<span class="go">[5] INFO: Argument 2: tres</span>
<span class="go">[1] DEBUG: Aquí s&#39;acaba el main()</span>
</pre></div>
</div>
<p>Fixa't que tant la primera línia de cada execució, com la darrera comencen
sempre per 1.</p>
</section>
</section>


           </div>
          </div>
    <div class="googleanalytics">
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>
    <script>setCookiesboxVisibility();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41103782-2', 'auto');
      ga('send', 'pageview');
    </script>
</div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="exercici_33_05_traduccio.html" class="btn btn-neutral float-left" title="Exercici 33_05. Traducció" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="exercici_33_07_classificador.html" class="btn btn-neutral float-right" title="Exercici 33_07. Classificador de matrícules" accesskey="n" rel="next">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024 Moisès Gómez Girón.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41103782-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-41103782-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>