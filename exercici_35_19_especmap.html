<!DOCTYPE html>
<html class="writer-html5" lang="ca" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercici 35_19. Propietats del vi &mdash; Introducció a la programació amb Java 2023-24 documentació</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="_static/moistyle.css?v=0e2f4d36" />

  
    <link rel="shortcut icon" href="_static/logoprg.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4385e19b"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=d8dd923b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="Quant a aquests documents" href="about.html" />
    <link rel="index" title="Índex" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="next" title="Validació d&#39;aplicacions" href="test.html" />
    <link rel="prev" title="Exercici 35_18. EnvoltaString és compara amb Strings" href="exercici_35_18_envoltastring_str.html" />
     
    <script class="googleanalytics" src="_static/moiscripts.js"></script>
    <meta name="robots" content="noindex">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Introducció a la programació amb Java
              <img src="_static/logoprg.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Curs 2023-24
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="primeres_passes.html">Primeres passes</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Elements bàsics de la programació</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduls.html">Mòduls</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitxers.html">Fitxers</a></li>
<li class="toctree-l1"><a class="reference internal" href="poo.html">Programació Orientada a Objectes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bib.html">Biblioteques</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bib_botigavins.html">El celler de la Bona Estrella</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_csv.html">Guardem les dades</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_vi.html">Vins complets</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_excepcions.html">Excepcions</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_enum.html">Enumerats</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_lists.html">Llistes</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_maps.html">Clau-Valor</a></li>
<li class="toctree-l2"><a class="reference internal" href="bib_conclusions.html">Conclusions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bib_exercicis.html">Exercicis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exercici_35_01_vi.html"> Exercici 35_01. La classe <code class="docutils literal notranslate"><span class="pre">vi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_02_botiga.html"> Exercici 35_02. La classe <code class="docutils literal notranslate"><span class="pre">botiga</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_03_entorn.html"> Exercici 35_03. La classe <code class="docutils literal notranslate"><span class="pre">Entorn</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_04_csv.html"> Exercici 35_04. Guardem les dades</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_05_vi_ampliat.html"> Exercici 35_05. El Vi ampliat</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_06_hores_controlades.html"> Exercici 35_06. La classe <code class="docutils literal notranslate"><span class="pre">Hora</span></code> amb control d'errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_07_hores_excepcionals.html"> Exercici 35_07. La classe Hora amb excepcions</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_08_hores_ilegals.html"> Exercici 35_08. La classe Hora amb <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_09_botiga_excepcional.html"> Exercici 35_09. Excepcions a la botiga de vins</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_10_gatposicio.html"> Exercici 35_10. Les posicions del gat Renat</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_11_viprotegit.html"> Exercici 35_11. El vi protegit</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_12_list.html"> Exercici 35_12. La classe <code class="docutils literal notranslate"><span class="pre">UsaList</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_13_remove.html"> Exercici 35_13. Comparació de <code class="docutils literal notranslate"><span class="pre">remove()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_14_botigacerca.html"> Exercici 35_14. Cerques de vi amb múltiples resultats</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_15_especs.html"> Exercici 35_15. Especificacions de vi</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_16_mouespecs.html"> Exercici 35_16. Especificacions independents</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_17_envoltastring_case.html"> Exercici 35_17. EnvoltaString indiferent a majúscules i minúscules</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercici_35_18_envoltastring_str.html"> Exercici 35_18. EnvoltaString és compara amb Strings</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Exercici 35_19. Propietats del vi</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Validació d'aplicacions</a></li>
<li class="toctree-l1"><a class="reference internal" href="refactoring.html">Refactoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="bd.html">Persistència amb bases de dades</a></li>
<li class="toctree-l1"><a class="reference internal" href="apendix.html">Apèndix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Introducció a la programació amb Java</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="bib.html">Biblioteques</a></li>
          <li class="breadcrumb-item"><a href="bib_exercicis.html">Exercicis</a></li>
      <li class="breadcrumb-item active"> Exercici 35_19. Propietats del vi</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="exercici_35_18_envoltastring_str.html" class="btn btn-neutral float-left" title="Exercici 35_18. EnvoltaString és compara amb Strings" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="test.html" class="btn btn-neutral float-right" title="Validació d&#39;aplicacions" accesskey="n">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    
           <div itemprop="articleBody">
             
  <section id="exerciseicon-t-exercici-35-19-propietats-del-vi">
<h1><img alt="exerciseicon__T" src="_images/exerciseicon__T.png" /> Exercici 35_19. Propietats del vi<a class="headerlink" href="#exerciseicon-t-exercici-35-19-propietats-del-vi" title="Enllaça amb aquesta capçalera"></a></h1>
<p class="rubric">Context</p>
<ul class="simple">
<li><p>Carpeta de lliurament: <code class="docutils literal notranslate"><span class="pre">35_19_especmap/</span></code></p></li>
<li><p>Continguts relacionats: <a class="reference internal" href="bib_maps.html"><span class="doc">Clau-Valor</span></a></p></li>
<li><p>Com lliurar-lo: <a class="reference internal" href="com_lliurar.html#instruccions-git"><span class="std std-ref">instruccions</span></a></p></li>
<li><p>[✓] Exercici amb <a class="reference internal" href="sobre_exercicis.html#descripcio-exercicis-autoavaluacio"><span class="std std-ref">autoavaluació</span></a></p></li>
</ul>
<p class="rubric">Enunciat</p>
<p>El disseny de la nostra aplicació s'ha flexibilitzat moltíssim. Ara podem
afegir noves propietats de vi amb certa facilitat i només haurem de
modificar <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code> i <code class="docutils literal notranslate"><span class="pre">Entorn</span></code>. No està malament!</p>
<p>Amb tot, encara ho podem fer millor. I ho farem!</p>
<section id="on-estem">
<h2>On estem?<a class="headerlink" href="#on-estem" title="Enllaça amb aquesta capçalera"></a></h2>
<p>En primer lloc reconsiderem <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code>. Es tracta d'una classe que
conté les propietats que especifiquen un vi, de moment nom, origen, tipus
i collita.</p>
<p>Per altra banda, les especificacions es fan servir per dues coses:</p>
<ul class="simple">
<li><p>definir els valors de les propietats d'un vi concret</p></li>
<li><p>definir una plantilla per especificar una cerca</p></li>
</ul>
<p>Quan actua com a plantilla, els valors dels atributs d'especificació
poden:</p>
<ul class="simple">
<li><p>no estar definits (<code class="docutils literal notranslate"><span class="pre">null</span></code>) indicant que és vàlid qualsevol valor per
aquesta propietat</p></li>
<li><p>ser parcials. Per exemple, la propietat <code class="docutils literal notranslate"><span class="pre">nom</span></code> pot valer <code class="docutils literal notranslate"><span class="pre">&quot;ro&quot;</span></code> que
permetrà el nom del vi <code class="docutils literal notranslate"><span class="pre">&quot;Roura</span> <span class="pre">blanc&quot;</span></code>.</p></li>
</ul>
<p>Per poder saber si una especificació actua com a plantilla o bé defineix
els valors, disposem del mètode <code class="docutils literal notranslate"><span class="pre">esComplet()</span></code> i per saber si un vi
concret és acceptable per una determinada plantilla, ara per ara disposem
de <code class="docutils literal notranslate"><span class="pre">esPlantillaDe()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Entorn</span></code> demana les dades de la cerca i per això està obligat a saber
que cal nom, origen, tipus i collita.</p>
<p>Com podríem aconseguir que <code class="docutils literal notranslate"><span class="pre">Entorn</span></code> pogués demanar el valor de les
propietats sense saber quines són?</p>
</section>
<section id="la-classe-propietat">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">Propietat</span></code><a class="headerlink" href="#la-classe-propietat" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Després d'unes intenses sessions de <em>brainstorming</em> dins l'equip, hem
arribat a la conclusió que ens cal una classe <code class="docutils literal notranslate"><span class="pre">Propietat</span></code> que representi
una propietat de <code class="docutils literal notranslate"><span class="pre">Vi</span></code>.</p>
<ul>
<li><p>nom de la propietat: ex. nom, collita, etc.</p>
<p>El nom ha de ser necessari per tota propietat i serà de tipus
<code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code> (un enumerat del que parlem més tard)</p>
<p>Afegirem el corresponent <em>getter</em>
<code class="docutils literal notranslate"><span class="pre">NomPropietat</span> <span class="pre">getNom()</span></code></p>
</li>
<li><p>un mètode per construir-la a partir d'un valor de tipus String, que ens
avisi quan el valor no sigui adequat. El mètode es dirà
<code class="docutils literal notranslate"><span class="pre">fromString(String)</span></code> i retornarà <code class="docutils literal notranslate"><span class="pre">null</span></code> si el valor rebut no és
vàlid per la propietat.</p>
<p>Com que el funcionament d'aquest mètode depen del tipus de propietat
concret, farem que el mètode sigui abstracte.</p>
</li>
<li><p>un mètode per indicar si el seu valor és acceptable per la plantilla que
rep com a paràmetre: <code class="docutils literal notranslate"><span class="pre">esAcceptableComAPlantilla(String)</span></code>.</p>
<p>Aquest mètode també haurà de ser abstracte.</p>
</li>
<li><p>si bé no és imprescindible, pot resultar molt còmode per depurar
reescriure el mètode <code class="docutils literal notranslate"><span class="pre">toString()</span></code>. Es proposa la següent implementació
que presenta com a curiositat el fet de fer servir un mètode abstracte
dins d'un mètode no abstracte. Això és programar pel futur, oi?</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nd">@Override</span>
<span class="linenos">2</span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">3</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%s(%s: %s)&quot;</span><span class="p">,</span>
<span class="linenos">4</span><span class="w">                         </span><span class="k">this</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">(),</span>
<span class="linenos">5</span><span class="w">                         </span><span class="n">getNom</span><span class="p">(),</span>
<span class="linenos">6</span><span class="w">                         </span><span class="n">getValorComString</span><span class="p">());</span>
<span class="linenos">7</span><span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Propietat</span></code> serà abstracta i disposarà de les subclasses
<code class="docutils literal notranslate"><span class="pre">PropietatEnterPositiu</span></code>, <code class="docutils literal notranslate"><span class="pre">PropietatString</span></code>, <code class="docutils literal notranslate"><span class="pre">PropietatOrigen</span></code> i
<code class="docutils literal notranslate"><span class="pre">PropietatTipus</span></code>.</p>
<figure class="align-center" id="id1">
<p class="plantuml">
<img src="_images/plantuml-4d7fea50f722028e7bbbfe3c962759e39737dcfc.png" alt="abstract class Propietat {
    - nom: NomPropietat
    + Propietat(NomPropietat)
    + getNom(): NomPropietat
    + {abstract} getValorComString(): String
    + {abstract} esAcceptableComAPlantilla(String): boolean
}

class PropietatEnterPositiu extends Propietat
class PropietatString extends Propietat
class PropietatOrigen extends Propietat
class PropietatTipus extends Propietat

hide class circle
hide abstract circle
hide enum circle
hide enum method
skinparam classAttributeIconSize 0
skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}"/>
</p>
<figcaption>
<p><span class="caption-text">La classe <code class="docutils literal notranslate"><span class="pre">Propietat</span></code></span><a class="headerlink" href="#id1" title="Enllaça amb aquesta imatge"></a></p>
</figcaption>
</figure>
</section>
<section id="la-classe-propietatenterpositiu">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">PropietatEnterPositiu</span></code><a class="headerlink" href="#la-classe-propietatenterpositiu" title="Enllaça amb aquesta capçalera"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PropietatEnterPositiu</span></code>: aquesta propietat disposarà d'un valor de
tipus enter que oferirà amb l'accessor <code class="docutils literal notranslate"><span class="pre">getValor()</span></code></p>
<p>El mètode <code class="docutils literal notranslate"><span class="pre">esAcceptableComAPlantilla()</span></code> retornarà <code class="docutils literal notranslate"><span class="pre">true</span></code> quan:</p>
<ul class="simple">
<li><p>la plantilla normalitzada sigui <code class="docutils literal notranslate"><span class="pre">null</span></code>, o bé</p></li>
<li><p>la plantilla sigui convertible a un enter i aquest coincideixi amb
<code class="docutils literal notranslate"><span class="pre">valor</span></code>.</p></li>
</ul>
<p>En la resta de casos retornarà <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<p>Per crear una instància d'aquesta classe, el més segur és usar el mètode
estàtic <code class="docutils literal notranslate"><span class="pre">fromString()</span></code>, que requerirà els paràmetres:</p>
<ul>
<li><p>el nom de la propietat: un <code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code></p></li>
<li><p>el tipus de comparació: un <code class="docutils literal notranslate"><span class="pre">TipusComparacio</span></code></p>
<p>Els valors vàlids seran <code class="docutils literal notranslate"><span class="pre">MAXIM</span></code> i <code class="docutils literal notranslate"><span class="pre">MINIM</span></code>. En altre
cas generarà un <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code></p>
</li>
<li><p>el valor de la propietat com a String.</p></li>
</ul>
<p>En cas que el valor sigui vàlid (un enter positiu) crearà una instància
i la retornarà.</p>
<p>El constructor d'aquesta classe llençarà una <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code>
en cas que el nom de la propietat, el tipus de comparació o el valor
no siguin vàlids.</p>
<p>Nota: En aquests moments no hi ha cap propietat de <code class="docutils literal notranslate"><span class="pre">Vi</span></code> que requereixi
una comparació exacta entre enters positius. Però com que gairebé costa
més no contemplar-la, simplement l'afegirem.</p>
<p>El <code class="docutils literal notranslate"><span class="pre">TipusComparacio.MAXIM</span></code> serà adequat per gestionar el <em>preu</em> mentre
que <code class="docutils literal notranslate"><span class="pre">MINIM</span></code> és adequat per <em>estoc</em>.</p>
<p>Es proposa la següent implementació del mètode
<code class="docutils literal notranslate"><span class="pre">esAcceptableComAPlantilla()</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">esAcceptableComAPlantilla</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">plantilla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">plantilla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UtilString</span><span class="p">.</span><span class="na">normalitzaString</span><span class="p">(</span><span class="n">plantilla</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">plantilla</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">UtilString</span><span class="p">.</span><span class="na">esEnter</span><span class="p">(</span><span class="n">plantilla</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">valorPlantilla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">plantilla</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">comparacio</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">MAXIM</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">valor</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">valorPlantilla</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">comparacio</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">MINIM</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">valor</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">valorPlantilla</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">valor</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">valorPlantilla</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="la-classe-propietatstring">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">PropietatString</span></code><a class="headerlink" href="#la-classe-propietatstring" title="Enllaça amb aquesta capçalera"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PropietatString</span></code>: Aquesta classe representarà una propietat amb valor
de tipus String. <code class="docutils literal notranslate"><span class="pre">esAcceptableComAPlantilla()</span></code> retornarà <code class="docutils literal notranslate"><span class="pre">true</span></code> quan
la plantilla normalitzada correspongui a <code class="docutils literal notranslate"><span class="pre">null</span></code> o sigui exactament igual
a <code class="docutils literal notranslate"><span class="pre">valor</span></code>.</p>
<p>Com <code class="docutils literal notranslate"><span class="pre">PropietatEnterPositiu</span></code>, aquesta classe també disposarà d'un atribut
<code class="docutils literal notranslate"><span class="pre">TipusComparacio</span></code> que permetrà indicar la manera en que es comportarà
<code class="docutils literal notranslate"><span class="pre">esAcceptableComAPlantilla()</span></code></p>
<p>Quan el tipus de comparació sigui <code class="docutils literal notranslate"><span class="pre">EXACTE</span></code> la propietat serà adequada
per implementar <em>referència</em>, <em>lloc</em> i <em>collita</em>.</p>
<p>Quan el tipus de comparació sigui <code class="docutils literal notranslate"><span class="pre">INICIAL</span></code>, la propietat serà adequada
per <em>nom</em>.</p>
<p>Altres tipus de comparació diferents de <code class="docutils literal notranslate"><span class="pre">EXACTE</span></code> i <code class="docutils literal notranslate"><span class="pre">INICIAL</span></code>
provocaran una <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code></p>
</section>
<section id="les-classes-propietatorigen-i-propietattipus">
<h2>Les classes <code class="docutils literal notranslate"><span class="pre">PropietatOrigen</span></code> i <code class="docutils literal notranslate"><span class="pre">PropietatTipus</span></code><a class="headerlink" href="#les-classes-propietatorigen-i-propietattipus" title="Enllaça amb aquesta capçalera"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PropietatOrigen</span></code> i <code class="docutils literal notranslate"><span class="pre">PropietatTipus</span></code>: Aquestes subclasses estan
pensades per implementar <em>origen</em> i <em>tipus</em> del vi. Tindran una propietat
<code class="docutils literal notranslate"><span class="pre">valor</span></code> de tipus <code class="docutils literal notranslate"><span class="pre">Origen</span></code> i <code class="docutils literal notranslate"><span class="pre">Tipus</span></code> respectivament, més el <em>getter</em>
corresponent.</p>
<p>Com que aquestes classes són molt específiques per les propietats <em>origen</em>
i <em>tipus</em>, no caldrà que li diguem el nom de la propietat.</p>
<p>Cal tenir present que totes les subclasses de propietat que s'ofereixen
són immutables. Això implica que <code class="docutils literal notranslate"><span class="pre">valor</span></code> serà declarat com a <code class="docutils literal notranslate"><span class="pre">final</span></code>.</p>
</section>
<section id="l-enumerat-nompropietat">
<h2>L'enumerat <code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code><a class="headerlink" href="#l-enumerat-nompropietat" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Disposem de diferents tipus de propietats. Per exemple, el nom, el preu o
l'origen.</p>
<p>Com que el nostre objectiu és permetre que <code class="docutils literal notranslate"><span class="pre">Entorn</span></code> no hagi de saber
quines propietats concretes té el vi, hi afegirem la informació del
<em>prompt</em> que ha de presentar <code class="docutils literal notranslate"><span class="pre">Entorn</span></code> quan demana les dades de cerca.</p>
<p>El codi d'aquest enumerat podria ser:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">NomPropietat</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">     </span><span class="n">REF</span><span class="w">     </span><span class="p">(</span><span class="s">&quot;ref&quot;</span><span class="p">),</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="n">NOM</span><span class="w">     </span><span class="p">(</span><span class="s">&quot;nom&quot;</span><span class="p">),</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="n">PREU</span><span class="w">    </span><span class="p">(</span><span class="s">&quot;preu max.&quot;</span><span class="p">),</span>
<span class="linenos"> 5</span><span class="w">     </span><span class="n">ESTOC</span><span class="w">   </span><span class="p">(</span><span class="s">&quot;estoc min.&quot;</span><span class="p">),</span>
<span class="linenos"> 6</span><span class="w">     </span><span class="n">LLOC</span><span class="w">    </span><span class="p">(</span><span class="s">&quot;lloc&quot;</span><span class="p">),</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="n">ORIGEN</span><span class="w">  </span><span class="p">(</span><span class="s">&quot;D.O.&quot;</span><span class="p">),</span>
<span class="linenos"> 8</span><span class="w">     </span><span class="n">TIPUS</span><span class="w">   </span><span class="p">(</span><span class="s">&quot;tipus&quot;</span><span class="p">),</span>
<span class="linenos"> 9</span><span class="w">     </span><span class="n">COLLITA</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;collita&quot;</span><span class="p">);</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">     </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">textPrompt</span><span class="p">;</span>
<span class="linenos">12</span><span class="w">     </span><span class="n">NomPropietat</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">textPrompt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">13</span><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="na">textPrompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textPrompt</span><span class="p">;</span>
<span class="linenos">14</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">15</span><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getTextPrompt</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">textPrompt</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos">16</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="l-enumerat-tipuscomparacio">
<h2>L'enumerat <code class="docutils literal notranslate"><span class="pre">TipusComparacio</span></code><a class="headerlink" href="#l-enumerat-tipuscomparacio" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Com hem vist, algunes de les subclasses de <code class="docutils literal notranslate"><span class="pre">Propietat</span></code> necessiten
indicar el tipus de comparació que es tindrà en comptes quan s'estigui
considerant si una propietat és acceptada o no per una plantilla.</p>
<p>El codi que es proposa és el següent:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">TipusComparacio</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">2</span><span class="w">     </span><span class="n">EXACTE</span><span class="p">,</span><span class="w">     </span><span class="c1">// el valor ha de ser exactament igual a la plantilla</span>
<span class="linenos">3</span><span class="w">     </span><span class="n">MINIM</span><span class="p">,</span><span class="w">      </span><span class="c1">// per numèrics, el valor no pot ser inferior a la plantilla</span>
<span class="linenos">4</span><span class="w">     </span><span class="n">MAXIM</span><span class="p">,</span><span class="w">      </span><span class="c1">// per numèrics, el valor no pot ser superior a la plantilla</span>
<span class="linenos">5</span><span class="w">     </span><span class="n">INICIAL</span><span class="w">     </span><span class="c1">// per Strings, el valor ha de començar com la plantilla</span>
<span class="linenos">6</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>De moment no sembla que calgui afegir-hi gaire més informació.</p>
</section>
<section id="la-classe-vi">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">Vi</span></code><a class="headerlink" href="#la-classe-vi" title="Enllaça amb aquesta capçalera"></a></h2>
<p>La classe <code class="docutils literal notranslate"><span class="pre">Vi</span></code> també es veu força modificada ja que les propietats d'un
vi es codificaran amb instàncies de <code class="docutils literal notranslate"><span class="pre">Propietat</span></code>.</p>
<p>Hem decidit guardar totes les propietats en un <code class="docutils literal notranslate"><span class="pre">Map</span></code> amb clau
<code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code> i valor <code class="docutils literal notranslate"><span class="pre">Propietat</span></code>. Li direm <code class="docutils literal notranslate"><span class="pre">propietats</span></code> i
emmagatzemarà <em>totes</em> les propietats.</p>
<p>El constructor específic construirà una instància de <code class="docutils literal notranslate"><span class="pre">Vi</span></code> sempre i quan
el paràmetre <code class="docutils literal notranslate"><span class="pre">propietats</span></code> contingui entrades per <strong>totes</strong> les
propietats necessàries. Altrament llençarà l'excepció
<code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code>.</p>
<p>El mètode <code class="docutils literal notranslate"><span class="pre">esValid()</span></code> rep un <code class="docutils literal notranslate"><span class="pre">Map</span></code> de propietats i retorna <code class="docutils literal notranslate"><span class="pre">true</span></code>
quan aquestes contenen totes les propietats necessàries per construir un
<code class="docutils literal notranslate"><span class="pre">Vi</span></code>. Hem decidit oferir-lo públic per permetre evitar l'excepció amb el
constructor.</p>
<p>És proposa la següent implementació (parcial) de <code class="docutils literal notranslate"><span class="pre">esValid()</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">esValid</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">NomPropietat</span><span class="p">,</span><span class="w"> </span><span class="n">Propietat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">propietats</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">     </span><span class="c1">// comprovació nombre de propietats</span>
<span class="linenos"> 3</span><span class="w">     </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">NomPropietat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">noms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">propietats</span><span class="p">.</span><span class="na">keySet</span><span class="p">();</span>
<span class="linenos"> 4</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">noms</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">propietatsSeleccionables</span><span class="p">.</span><span class="na">size</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="w">     </span><span class="c1">// comprovació disponibilitat de les propietats</span>
<span class="linenos"> 7</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">noms</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">REF</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">noms</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">NOM</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">     </span><span class="c1">// XXX completar</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">     </span><span class="c1">// comprovació les propietats no són null</span>
<span class="linenos">12</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">REF</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">13</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">NOM</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">14</span><span class="w">     </span><span class="c1">// XXX completar</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="w">     </span><span class="c1">// comprovació les propietats són del tipus esperat</span>
<span class="linenos">17</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">REF</span><span class="p">)</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">PropietatString</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">18</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">)</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">PropietatEnterPositiu</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">19</span><span class="w">     </span><span class="c1">// XXX completar</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="w">     </span><span class="c1">// comprovació les propietats tenen el tipus de comparació esperat</span>
<span class="linenos">22</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">((</span><span class="n">PropietatString</span><span class="p">)</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">REF</span><span class="p">)).</span><span class="na">getTipusComparacio</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">EXACTE</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">23</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">((</span><span class="n">PropietatString</span><span class="p">)</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">NOM</span><span class="p">)).</span><span class="na">getTipusComparacio</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">INICIAL</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">24</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">((</span><span class="n">PropietatEnterPositiu</span><span class="p">)</span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">)).</span><span class="na">getTipusComparacio</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">MAXIM</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">25</span><span class="w">     </span><span class="c1">// XXX completar</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos">28</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Com que les propietats seran guardades en un <code class="docutils literal notranslate"><span class="pre">Map</span></code>, els accessors
s'hauran d'adaptar a aquesta nova implementació.</p>
<p>Hem decidit oferir un <em>getter</em> per a totes les propietats que retornarà el
valor de la propietat demanada en forma de String. Per exemple, obtindrem
el nom amb <code class="docutils literal notranslate"><span class="pre">vi.get(NomPropietat.NOM)</span></code>.</p>
<p>Per comoditat, afegirem també <em>getters</em> específics per algunes de les
propietats. En concret, per la referència, el lloc, el preu i l'estoc. Com
que, excepte per la referència, aquests atributs són modificables,
afegirem també <em>setters</em>.</p>
<p>Un exemple d'implementació dels accessors de <em>preu</em> seria:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getPreu</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 2</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="n">PropietatEnterPositiu</span><span class="p">)</span><span class="w"> </span><span class="n">propietats</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">)).</span><span class="na">getValor</span><span class="p">();</span>
<span class="linenos"> 3</span><span class="w"> </span><span class="p">}</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPreu</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">preu</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">preu</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 7</span><span class="w">         </span><span class="n">Propietat</span><span class="w"> </span><span class="n">propietat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropietatEnterPositiu</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="w">                 </span><span class="n">TipusComparacio</span><span class="p">.</span><span class="na">MAXIM</span><span class="p">,</span><span class="w"> </span><span class="n">preu</span><span class="p">);</span>
<span class="linenos"> 9</span><span class="w">         </span><span class="n">propietats</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">,</span><span class="w"> </span><span class="n">propietat</span><span class="p">);</span>
<span class="linenos">10</span><span class="w">     </span><span class="p">}</span>
<span class="linenos">11</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;El preu no pot ser negatiu&quot;</span><span class="p">);</span>
<span class="linenos">12</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Ja que volem que <code class="docutils literal notranslate"><span class="pre">Entorn</span></code> no hagi de saber res de les propietats a
demanar a l'hora de processar una cerca, haurem d'oferir algun mecanisme
per que es pugui determinar quines propietats han de ser demanades. Ens
hem decidit per definir una llista amb aquesta informació. Així, <code class="docutils literal notranslate"><span class="pre">Vi</span></code>
oferirà públicament la propietat immutable <code class="docutils literal notranslate"><span class="pre">propietatsSeleccionables</span></code>.
Es recomana la següent implementació:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">NomPropietat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">propietatsSeleccionables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="linenos">2</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">NOM</span><span class="p">,</span>
<span class="linenos">3</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">PREU</span><span class="p">,</span>
<span class="linenos">4</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">ESTOC</span><span class="p">,</span>
<span class="linenos">5</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">ORIGEN</span><span class="p">,</span>
<span class="linenos">6</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">TIPUS</span><span class="p">,</span>
<span class="linenos">7</span><span class="w">      </span><span class="n">NomPropietat</span><span class="p">.</span><span class="na">COLLITA</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">List.of()</span></code> ens ofereix una llista immutable amb els elements indicats.</p>
<p>Fixa't que no afegim ni la referència ni el lloc. La referència ha de ser
demanada independentment ja que té una cerca directa. En quant al lloc,
seguirem sense incloure'l com a criteri de cerca ja que el més probable és
que sigui la raó per la qual es fa la cerca.</p>
<p>Per què <code class="docutils literal notranslate"><span class="pre">Botiga</span></code> pugui decidir si un vi entra o no entre els resultats
d'una cerca, ens caldrà que <code class="docutils literal notranslate"><span class="pre">Vi</span></code> sigui capaç d'indicar si una instància
compleix o no una plantilla. Farem servir el mètode
<code class="docutils literal notranslate"><span class="pre">esValidPerPlantilla()</span></code>, que rep una plantilla en forma de <code class="docutils literal notranslate"><span class="pre">Map</span></code> amb
clau <code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code> i valor String, amb els valors corresponents per
cada element especificat a la cerca. El mètode revisarà que cada element
de la plantilla sigui acceptable pel valor de la corresponent propietat,
tot cridant el mètode <code class="docutils literal notranslate"><span class="pre">Propietat.esAcceptableComAPlantilla()</span></code> .</p>
<p>Finalment, caldrà fer una repassada d'altres elements de <code class="docutils literal notranslate"><span class="pre">Vi</span></code> que pugui
ser necessari modificar per adaptar-los a <code class="docutils literal notranslate"><span class="pre">Propietat</span></code>. Per exemple,
<code class="docutils literal notranslate"><span class="pre">toString()</span></code>.</p>
<p>El disseny de la classe <code class="docutils literal notranslate"><span class="pre">Vi</span></code> quedarà:</p>
<figure class="align-center" id="id2">
<p class="plantuml">
<img src="_images/plantuml-9dcf11ae4d065b257631dce29196ba54c1cb6567.png" alt="class Vi {
    - {static} propietatsSeleccionables: List&lt;NomPropietat&gt;
    - propietats: Map&lt;NomPropietat, Propietat&gt;
    + Vi(propietats: Map&lt;NomPropietat, Propietat&gt;)
    + {static} getNomsPropietatsSeleccionables(): List&lt;String&gt;
    + getRef(): String
    + getLloc(): String
    + get(nomPropietat: NomPropietat): String
    + getPreu(): int
    + setPreu(int)
    + getEstoc(): int
    + setEstoc(int)
    + getLloc(): String
    + setLloc(lloc)
    + toString(): String
    + esValidPerPlantilla(plantilla: Map&lt;NomPropietat, String&gt;): boolean
    + aArrayString(): String[]
    + {static} deArrayString(String[]): Vi
    + {statoc} esValid(propietats: Map&lt;NomPropietat, Propietat&gt;)
}

Vi *-- Propietat
Vi -&gt; NomPropietat

hide class circle
hide abstract circle
hide enum circle
hide enum method
skinparam classAttributeIconSize 0
skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}"/>
</p>
<figcaption>
<p><span class="caption-text">El nou disseny de la classe <code class="docutils literal notranslate"><span class="pre">Vi</span></code></span><a class="headerlink" href="#id2" title="Enllaça amb aquesta imatge"></a></p>
</figcaption>
</figure>
</section>
<section id="ens-acomiadem-de-especificacio">
<h2>Ens acomiadem de <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code><a class="headerlink" href="#ens-acomiadem-de-especificacio" title="Enllaça amb aquesta capçalera"></a></h2>
<p>La classe <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code> deixa de servir com a plantilla. La funció de
plantilla la realitzarà un <code class="docutils literal notranslate"><span class="pre">Map&lt;NomPropietat,</span> <span class="pre">String&gt;</span></code> on cada clau serà
el tipus de propietat i el valor serà una representació en forma de String
del valor de la propietat.</p>
<p>L'altra funció de <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code> era la de composar <code class="docutils literal notranslate"><span class="pre">Vi</span></code>, encapsulant
els membres que havien de ser considerats a l'hora d'aplicar una plantilla
durant la cerca. Aquesta funció la realitzarà un <code class="docutils literal notranslate"><span class="pre">Map</span></code> amb clau
<code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code> i valor <code class="docutils literal notranslate"><span class="pre">Propietat</span></code>.</p>
<p>Per tant, ja no ens cal la classe i li diem adéu. La tindrem sempre
present en els nostres cors o, si més no, en l'històric de <em>commits</em> del
nostre repositori.</p>
</section>
<section id="la-classe-botiga">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">Botiga</span></code><a class="headerlink" href="#la-classe-botiga" title="Enllaça amb aquesta capçalera"></a></h2>
<p>Aquesta classe requerirà alguns petits canvis en els mètodes de cerca que
requerien una <code class="docutils literal notranslate"><span class="pre">Especificacio</span></code>.</p>
<p>Reduïm els dos mètodes a un que rebrà com a paràmetre una plantilla
consistent en un <code class="docutils literal notranslate"><span class="pre">Map</span></code> amb clau <code class="docutils literal notranslate"><span class="pre">NomPropietat</span></code> i valor un String que
defineix la plantilla de cada propietat especificada.</p>
<p>Fixa't que amb aquest disseny la plantilla pot especificar que una
propietat no importa de dues maneres:</p>
<ul class="simple">
<li><p>associant-li un valor que en ser normalitzat es resolgui a <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p>simplement no incloent la propietat a la plantilla.</p></li>
</ul>
</section>
<section id="la-classe-entorn">
<h2>La classe <code class="docutils literal notranslate"><span class="pre">Entorn</span></code><a class="headerlink" href="#la-classe-entorn" title="Enllaça amb aquesta capçalera"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Entorn</span></code> requerirà alguns canvis en l'obtenció i processament dels
valors en processar l'opció de cerca. Tot plegat resultarà en una
simplificació interessant del codi.</p>
</section>
<section id="el-disseny-final-a-implementar">
<h2>El disseny final a implementar<a class="headerlink" href="#el-disseny-final-a-implementar" title="Enllaça amb aquesta capçalera"></a></h2>
<p>En resum, el nostre objectiu ara és aconseguir implementar el següent:</p>
<figure class="align-center" id="id3">
<p class="plantuml">
<img src="_images/plantuml-2f3dca531361754013949047fb6b125c7fdc1e2e.png" alt="enum Origen
enum Tipus
enum NomPropietat {
    REF
    NOM
    PREU
    ESTOC
    LLOC
    ORIGEN
    TIPUS
    COLLITA
}

enum TipusComparacio {
    EXACTE
    MAXIM
    MINIM
    INICIAL
}

class Botiga {
    + cerca(ref: String): Vi
    + cerca(plantilla: Map&lt;NomPropietat, String&gt;): List&lt;Vi&gt;
}

class Vi {
    - {static} propietatsSeleccionables: List&lt;NomPropietat&gt;
    - propietats: Map&lt;String, Propietat&gt;
    + Vi(propietats: Map&lt;NomPropietat, Propietat&gt;)
    + {static} getNomsPropietatsSeleccionables(): List&lt;String&gt;
    + getRef(): String
    + getLloc(): String
    + get(nomPropietat: String)
    + getPreu(): int
    + setPreu(int)
    + getEstoc(): int
    + setEstoc(int)
    + getLloc(): String
    + setLloc(lloc)
    + toString(): String
    + esValidPerPlantilla(plantilla: Map&lt;NomPropietat, String&gt;): boolean
    + aArrayString(): String[]
    + {static} deArrayString(String[]): Vi
    + esValid(propietats: Map&lt;NomPropietat, Propietat&gt;)
}

abstract class Propietat {
    - nom: NomPropietat
    + Propietat(NomPropietat)
    + getNom(): NomPropietat
    + {abstract} getValorComString(): String
    + {abstract} esAcceptableComAPlantilla(String): boolean
}

class PropietatEnterPositiu {
    - valor: int
    - comparacio: TipusComparacio
    + PropietatEnterPositiu(NomPropietat, TipusComparacio, int)
    + getValor(): int
    + getTipusComparacio(): TipusComparacio
    + {static} fromString(NomPropietat, TipusComparacio, String): PropietatEnterPositiu
}

class PropietatString {
    - valor: String
    - comparacio: TipusComparacio
    - PropietatString(NomPropietat, TipusComparacio, String)
    + getValor(): String
    + getTipusComparacio(): TipusComparacio
    + {static} fromString(NomPropietat, TipusComparacio, String): PropietatString
}

class PropietatOrigen {
    - valor: Origen
    + PropietatOrigen(Origen)
    + getValor(): Origen
    + {static} fromString(String): PropietatOrigen
}

class PropietatTipus {
    - valor: Tipus
    + PropietatTipus(Tipus)
    + getValor(): Tipus
    + {static} fromString(String): PropietatTipus
}

class PropietatString extends Propietat
class PropietatEnterPositiu extends Propietat
class PropietatOrigen extends Propietat
class PropietatTipus extends Propietat

Entorn *-- Botiga
Entorn --&gt; Vi
Botiga o-- Vi
Vi *-- Propietat
Propietat *-left- NomPropietat
PropietatOrigen *-down-&gt; Origen
PropietatTipus *-down-&gt; Tipus
PropietatEnterPositiu *-- TipusComparacio
PropietatString *-- TipusComparacio

enum NomPropietat #yellow
enum TipusComparacio #yellow
class Propietat #yellow
class PropietatEnterPositiu #yellow
class PropietatOrigen #yellow
class PropietatString #yellow
class PropietatTipus #yellow

hide class circle
hide abstract circle
hide enum circle
hide enum method
skinparam classAttributeIconSize 0
skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}"/>
</p>
<figcaption>
<p><span class="caption-text">Diagrama de classes de la botiga de vins amb <code class="docutils literal notranslate"><span class="pre">Propietat</span></code></span><a class="headerlink" href="#id3" title="Enllaça amb aquesta imatge"></a></p>
</figcaption>
</figure>
</section>
</section>


           </div>
          </div>
    <div class="googleanalytics">
    <div id="cookiesbox">
        Aquest lloc web utilitza galetes (<i>cookies</i>) per a analitzar el seu ús
        amb les eines que ofereix <a href="https://www.google.com/analytics">Google Analytics</a>.
        En continuar navegant-hi, estàs acceptant-ho.
        <br/>
        <a class="btn btn-neutral" onclick="setUserAcceptsCookies();">
            Tancar
            <span class="fa fa-window-close"></span>
        </a>
    </div>
    <script>setCookiesboxVisibility();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41103782-2', 'auto');
      ga('send', 'pageview');
    </script>
</div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="exercici_35_18_envoltastring_str.html" class="btn btn-neutral float-left" title="Exercici 35_18. EnvoltaString és compara amb Strings" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="test.html" class="btn btn-neutral float-right" title="Validació d&#39;aplicacions" accesskey="n" rel="next">Següent <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024 Moisès Gómez Girón.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41103782-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-41103782-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>